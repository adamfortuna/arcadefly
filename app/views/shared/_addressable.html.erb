<%- 
  # Example:
  #  render :partial => 'shared/addressables', :object => arcades, :locals => {:small_map => true, :map_type => false, :id => "#{addressables.first.class.to_s.downcase}_map"}

  options ||= {}
  options.reverse_merge!({:small_map => true, :map_type => false, :id => "#{addressable.class.to_s.downcase}_map", :class => "map_small right prepend-1 span-13 last map"})

  map = GMap.new(options[:id])
  map.control_init(options)

  map.center_zoom_init([addressable.address.public_lat, addressable.address.public_lng], 10)
  map.overlay_init(GMarker.new([addressable.address.public_lat, addressable.address.public_lng], :title => addressable.title, :info_window => map_bubble_for(addressable)))
-%>

<% javascript_files do  %>
  <%= javascript_include_tag GMap.google_js_path %>
  <%= javascript_include_merged :addressables %>
<% end %>

<% javascript do %>
	<%= map.to_html(:no_script_tag => true) %>
	$('<%=options[:class].split(' ').first%>_loading').hide();
<% end %>

<%= image_tag "#{ASSET_HOST}/images/spinner.gif", :id => "#{options[:class].split(' ').first}_loading" %>
<%= map.div(:class => options[:class]) %>